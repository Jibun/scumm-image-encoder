import common
import ega

tableEGAPalette = [
    0x00, 0x00, 0x00, 	0x00, 0x00, 0xAA, 	0x00, 0xAA, 0x00, 	0x00, 0xAA, 0xAA,
    0xAA, 0x00, 0x00, 	0xAA, 0x00, 0xAA, 	0xAA, 0x55, 0x00, 	0xAA, 0xAA, 0xAA,
    0x55, 0x55, 0x55, 	0x55, 0x55, 0xFF, 	0x55, 0xFF, 0x55, 	0x55, 0xFF, 0xFF,
    0xFF, 0x55, 0x55, 	0xFF, 0x55, 0xFF, 	0xFF, 0xFF, 0x55, 	0xFF, 0xFF, 0xFF
]

class DecoderV2(common.ImageDecoderBase):
    def readPalette(self, lflf_path, palette_num):
        return tableEGAPalette

    def readBitmap(self, lflf_path, bitmap_path, width, height, pal_data):
        bitmapFile = file(bitmap_path, 'rb')
        try:
            img_data = ega.decodeV2Bitmap(bitmapFile, width, height)
            return img_data
        finally:
            bitmapFile.close()
